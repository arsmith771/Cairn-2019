function closeText(e,n,t,i){jQuery(document).on("click",e,function(){jQuery(n).fadeOut();var e=document.getElementById(t),r=jQuery(i);e.pause(),r.addClass("paused"),r.removeClass("playing")})}function closeTextAll(){var e;for(e=0;e<18;e++)closeText("#story-screen__text__close--"+e,"#story-screen__text--"+e,"audio-"+e,"#ctrl-"+e)}function loadingAudio(){jQuery(document).on("click",".story-screen__audio-ctrl.playing",function(){jQuery(this).next(".story-screen__audio__loading").css("display","inline-block"),setTimeout(function(){jQuery(".story-screen__audio__loading").fadeOut()},2e3)})}function ctrlAudio(e,n){jQuery(e).on("click",function(){var e=document.getElementById(n);jQuery(this).hasClass("paused")?(e.play(),jQuery(this).addClass("playing"),jQuery(this).removeClass("paused")):(e.pause(),jQuery(this).addClass("paused"),jQuery(this).removeClass("playing"))})}function ctrlAudioAll(){var e;for(e=0;e<18;e++)ctrlAudio("#ctrl-"+e,"audio-"+e)}function audioEnded(e,n){var t=document.getElementById(e),i=document.getElementById(n);t.addEventListener("ended",function(){i.classList.add("paused"),i.classList.remove("playing"),console.log("audio ended")})}function audioEndedAll(){var e;for(e=0;e<18;e++)audioEnded("audio-"+e,"ctrl-"+e)}function modalPosition(){jQuery(".story-screen").width()<320?jQuery(".story-screen__text").css("position","fixed"):jQuery(".story-screen__text").css("position","absolute")}function fadeOutLoadingModal(){jQuery("#loading-modal").fadeOut()}function toggleTextLayer(){jQuery(".text-cta").on("click",function(e){jQuery(this).closest(".story-screen__graphic").siblings(".story-screen__text").fadeIn(),console.log("clicked")}),jQuery(".text-cta").on("keypress",function(e){13==e.which&&jQuery(this).closest(".story-screen__graphic").siblings(".story-screen__text").fadeIn()})}function isElementinViewPort2(){jQuery(".story-screen").each(function(e){var n=document.getElementById("story-screen--"+e).getBoundingClientRect();n.top>=-100&&n.top<100?jQuery(this).addClass("animate"):jQuery(this).removeClass("animate")})}function screenBorders(){var e=window.innerWidth,n=jQuery(".story-screen"),t=n.eq(0).width();console.log(t+60,e),t+60<=e?(n.addClass("story-screen--with-border"),jQuery("body").addClass("body--with-graphics")):(n.removeClass("story-screen--with-border"),jQuery("body").removeClass("body--with-graphics"))}function leafAnim(){var e={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(e){for(var n=0;n<e.length;n++){var t=e[n].string,i=e[n].prop;if(this.versionSearchString=e[n].versionSearch||e[n].identity,t){if(-1!=t.indexOf(e[n].subString))return e[n].identity}else if(i)return e[n].identity}},searchVersion:function(e){var n=e.indexOf(this.versionSearchString);if(-1!=n)return parseFloat(e.substring(n+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};if(e.init(),!("Safari"===e.browser&&e.version<9)){var n=["red-leaf","brown-leaf","yellow-leaf","green-leaf"],t=["small-move","medium-move","large-move","large-move"],i=document.querySelector(".container"),r=0;setInterval(function(){var e=jQuery(".body--with-graphics").length;if("hidden"===document.visibilityState||e<1)console.info("Browser not in focus, so we will not generate new leaves");else{r>6&&(console.info("Limit reached on number of leaves  (6), so we are culling the oldest one..."),i.removeChild(i.querySelector(".leaf")));var o=document.createElement("div"),s=Math.floor(Math.random()*n.length);o.classList.add(n[s]);var a=Math.floor(Math.random()*t.length);o.classList.add(t[a]),o.classList.add("leaf");var d=document.createElement("div");d.classList.add("y-axis");var c=document.createElement("div");c.classList.add("x-axis"),d.appendChild(c),o.appendChild(d);var l=Math.random()*window.innerWidth;o.style.position="absolute",o.style.left=`${l}px`;o.style.top="-25vh",i.appendChild(o),r++}},1e3)}}function addFooter(){jQuery(".story-screen").not(".story-screen--10, .story-screen--16, .story-screen--15, .story-screen--13, .story-screen--11").each(function(){var e=jQuery(this),n=e.height(),t=e.find(".story-screen__graphic").height(),i=e.find(".story-screen--footer").length;n<t&&i<1?e.append('<div class="story-screen--footer" />'):n>=t&&e.find(".story-screen--footer").remove()})}jQuery(window).on("load",function(){leafAnim()}),jQuery("#app").on("scroll",function(){isElementinViewPort2()}),jQuery(document).ready(function(){screenBorders(),toggleTextLayer(),isElementinViewPort2(),addFooter(),closeTextAll(),loadingAudio(),ctrlAudioAll(),audioEndedAll(),modalPosition(),fadeOutLoadingModal()}),jQuery(window).on("resize",function(){screenBorders(),modalPosition()});